---
# Required variables are validated in tasks/validate.yml

matrix_user: matrix
matrix_home: /opt/matrix
matrix_uid: 987
matrix_gid: 987
matrix_shell: /usr/sbin/nologin

matrix_data_dir: "{{ matrix_home }}/data"
matrix_backup_dir: "{{ matrix_home }}/backups"
matrix_subuid_start: 100000
matrix_subuid_range: 65536

# Rootless user namespace mapping for postgres user (uid/gid 999 in container)
postgres_container_uid: 999
postgres_container_gid: 999
postgres_host_uid: "{{ (matrix_subuid_start | int) + (postgres_container_uid | int) - 1 }}"
postgres_host_gid: "{{ (matrix_subuid_start | int) + (postgres_container_gid | int) - 1 }}"

# Rootless user namespace mapping for synapse user (uid/gid 991 in container)
synapse_container_uid: 991
synapse_container_gid: 991
synapse_host_uid: "{{ (matrix_subuid_start | int) + (synapse_container_uid | int) - 1 }}"
synapse_host_gid: "{{ (matrix_subuid_start | int) + (synapse_container_gid | int) - 1 }}"

# Docker / Compose
docker_rootless: true
docker_compose_project: matrix

synapse_image: docker.io/matrixdotorg/synapse:latest
synapse_container_user: "{{ synapse_container_uid }}:{{ synapse_container_gid }}"
postgres_image: docker.io/postgres:16
nginx_image: docker.io/nginx:stable
synapse_admin_image: docker.io/etkecc/synapse-admin:latest
cloudflared_image: docker.io/cloudflare/cloudflared:latest
backup_image: docker.io/alpine:3.19
backup_image_local: matrix-backup:latest
cinny_image: cinny:local

cinny_repo: https://github.com/cinnyapp/cinny.git
cinny_version: v4.10.2
cinny_build_dir: "{{ matrix_home }}/cinny/src"
cinny_landing_text: "Hospital Internal Messaging"
cinny_custom_logo_path: ""
cinny_custom_background_path: ""

postgres_db: synapse
postgres_user: synapse

backup_time: "03:00"
backup_timezone: "UTC"

firewall_backend: ufw
firewall_allow_ssh: true
firewall_ssh_port: 22

# Derived
matrix_synapse_server_name: "{{ matrix_fqdn }}"
matrix_public_baseurl: "https://{{ matrix_fqdn }}/"
